{% extends "base.html" %}

{% block title %} Produtos Cadastrados {% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <h3 class="mb-4"> Produtos Cadastrados </h3>

        {% if produtos %}
        <div class="table-responsive">
            <table class="table table-bordered table-striped">
                <thead>
                <tr>
                    <th>Código</th>
                    <th>Descrição</th>
                    <th>Preço</th>
                    <th>Quantidade</th>
                    <th>Status</th>
                    <th>Editar/Apagar</th>
                </tr>
                </thead>
                <tbody>
                {% for produto in produtos %}
                <tr>
                    <td>{{ produto["codigo"] }}</td>
                    <td>{{ produto["descricao"] }}</td>
                    <td>R$ {{ "%.2f" | format(produto["preco"]) }}</td>
                    <td>{{ produto["quantidade"] }}</td>

                    <td>
                        {% if produto["quantidade"] < produto["quantidade_minima"] %}
                        <span class="badge bg-warning">Estoque baixo</span>
                        {% else %}
                        <span class="badge bg-info">Em estoque</span>
                        {% endif %}
                    </td>

                    <td>
                        <a href="{{ url_for('editar_produto', codigo=produto['codigo']) }}"
                           class="btn btn-outline-warning">Editar</a>

                        <form action="{{ url_for('apagar_produto', codigo=produto['codigo']) }}" method="POST"
                              style="display:inline">
                            <button type="submit" class="btn btn-outline-danger"
                                    onclick="return confirm('Apagar o produto {{ produto['descricao'] }}?');">Apagar
                            </button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="alert alert-primary text-center">
            Nenhum produto registrado!
        </div>
        {% endif %}

    </div>

</div>
{% endblock %}